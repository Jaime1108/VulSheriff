<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>VulnSherif</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" integrity="sha512-JFpccvzzakcL7D625Tn5wSO1G4+pjaHDF8ddQc+qZ5s0sWWJTWfXh8BUXeM8B8i3cBG1greRr1HW6/2tTvZQkA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/report.css') }}">
  {% block head %}{% endblock %}
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.75em' font-size='80'>ðŸ”’</text></svg>">
  <meta name="robots" content="noindex,nofollow">
  <meta http-equiv="Cache-control" content="no-cache">
  <style>
    #loading-overlay {
      position: fixed;
      inset: 0;
      background: rgba(5, 7, 15, 0.82);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(6px);
    }
    #loading-box {
      text-align: center;
      background: #10172b;
      border: 1px solid rgba(122, 0, 255, 0.4);
      border-radius: 16px;
      padding: 24px 32px;
      color: #eef2ff;
      box-shadow: 0 20px 48px rgba(3, 4, 8, 0.65);
    }
    .spinner-ring {
      width: 64px;
      height: 64px;
      border: 6px solid rgba(122, 0, 255, 0.2);
      border-top-color: rgba(122, 0, 255, 0.8);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 12px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body class="app-body">
  <div id="loading-overlay" aria-hidden="true">
    <div id="loading-box">
      <div class="spinner-ring" role="status" aria-label="Loading"></div>
      <div class="fw-semibold mb-1">LLM is analyzing your codeâ€¦</div>
      <div style="font-size: 0.95rem; color: rgba(226, 232, 240, 0.75);">Hang tight while the findings are prepared.</div>
    </div>
  </div>

  <div class="app-wrapper">
    <header class="top-bar">
      <a class="brand-link" href="{{ url_for('index') }}">Vuln<span>Sherif</span></a>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, message in messages %}
            <div class="alert alert-{{ 'danger' if category == 'error' else category }}" role="alert">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <main class="app-main">
      {% block content %}{% endblock %}
    </main>

    <footer class="app-footer">
      Tip: set OPENROUTER_API_KEY in your environment. Only selected text files are uploaded and oversized files are truncated to protect tokens.
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-wbN3QGDH9IP2XKhWfQm1nN0sWIpnY3uRVQ4l2s2s8s2zC1n8e5Q/3pHqv3H+0r3B/6hI0F6C2ZQmE2j3B7bYFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>try{hljs.highlightAll();}catch(e){}</script>
  <script>
    (function(){
      function showOverlay(){
        var el = document.getElementById('loading-overlay');
        if (el) { el.style.display = 'flex'; }
      }
      document.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('form.show-loading-on-submit').forEach(function(f){
          f.addEventListener('submit', function(){
            showOverlay();
            var btn = f.querySelector("button[type='submit']");
            if (btn) { btn.disabled = true; btn.classList.add('disabled'); }
          });
        });
        document.querySelectorAll('[data-loading]')
          .forEach(function(el){ el.addEventListener('click', showOverlay); });

        document.addEventListener('click', function(e){
          var btn = e.target.closest('.copy-btn');
          if (!btn) return;
          var id = btn.getAttribute('data-copy-target');
          var target = document.getElementById(id);
          if (!target) return;
          var text = target.textContent || target.innerText || '';
          navigator.clipboard.writeText(text).then(function(){
            var original = btn.textContent;
            btn.textContent = 'Copied';
            setTimeout(function(){ btn.textContent = original; }, 1200);
          }).catch(function(){});
        });

        document.addEventListener('click', function(e){
          var trigger = e.target.closest('[data-toggle="collapsible"]');
          if (!trigger) return;
          var targetId = trigger.getAttribute('data-target');
          var content = document.getElementById(targetId);
          if (!content) return;
          var expanded = trigger.getAttribute('aria-expanded') === 'true';
          trigger.setAttribute('aria-expanded', String(!expanded));
          content.classList.toggle('open', !expanded);
        });
      });
    })();
  </script>
</body>
</html>
