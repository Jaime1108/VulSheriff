{% extends 'base.html' %}
{% block content %}

<div class="row g-3">
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <h6 class="card-title">Request Summary</h6>
        <ul class="list-unstyled mb-0">
          <li><strong>Files Included:</strong> {{ files_included }} / {{ max_files }}</li>
          <li><strong>Text Size:</strong> {{ text_size }}</li>
          <li><strong>Model:</strong> {{ model }}</li>
          <li><strong>Temperature:</strong> {{ '%.1f'|format(temperature) }}</li>
          <li><strong>Elapsed:</strong> {{ elapsed }}</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col-md-9">
    <div class="card mb-3">
      <div class="card-body">
        <h6 class="card-title">OpenRouter Response</h6>
        {% if content %}
          <div class="border rounded p-2" style="background:#f8f9fa;">
            <pre>{{ content }}</pre>
          </div>
        {% else %}
          <pre>{{ response_json | tojson(indent=2) }}</pre>
        {% endif %}
      </div>
    </div>

    {% if parsed_json %}
    <div class="card mb-3">
      <div class="card-body">
        <h6 class="card-title">Parsed Findings (JSON)</h6>
        <pre>{{ parsed_json | tojson(indent=2) }}</pre>
      </div>
    </div>
    {% endif %}

    <div class="card">
      <div class="card-body">
        <h6 class="card-title">Packaged File Context (preview)</h6>
        <pre>{{ packaged_preview }}</pre>
      </div>
    </div>
    {% if debug_mode and debug_details %}
    <div class="card mt-3">
      <div class="card-body">
        <h6 class="card-title">Debug Details</h6>
        <pre>{{ debug_details | tojson(indent=2) }}</pre>
      </div>
    </div>
    {% endif %}
  </div>
</div>

<div class="mt-3">
  <a class="btn btn-secondary" href="{{ url_for('index') }}">Run another analysis</a>
  <a class="btn btn-outline-secondary" href="{{ url_for('index') }}#" onclick="history.back();return false;">Back</a>
  </div>

{% endblock %}
