{% extends 'base.html' %}
{% block content %}
<div class="input-card">
  <h2 class="mb-3">Launch a scan</h2>
  <p class="text-muted mb-4">Upload your project ZIP or run a prompt-only check. We&#39;ll package source files, call the model, and render a structured report.</p>
  <form action="{{ url_for('analyze') }}" method="post" enctype="multipart/form-data" class="row g-3 show-loading-on-submit">
    <div class="col-12">
      <label for="zip_file" class="form-label">1) Project ZIP</label>
      <input class="form-control" type="file" id="zip_file" name="zip_file" accept=".zip">
      <div class="form-text">Optional for testing. Included files capped at {{ max_files }} files, {{ max_total }} total, {{ max_file }} per file.</div>
    </div>

    <div class="col-12">
      <label for="notes" class="form-label">2) Analysis Context (optional)</label>
      <textarea class="form-control" id="notes" name="notes" rows="4" placeholder="e.g., Django + React; prioritize auth flows and API endpoints"></textarea>
    </div>

    <div class="col-12 form-check">
      <input class="form-check-input" type="checkbox" value="on" id="prompt_only" name="prompt_only">
      <label class="form-check-label" for="prompt_only">
        Prompt-only (no ZIP) &mdash; send just the text above
      </label>
      <div class="form-text">Leave ZIP empty and check this to test the Gemini call with your notes only.</div>
    </div>

    <div class="col-12 form-check">
      <input class="form-check-input" type="checkbox" value="on" id="debug" name="debug">
      <label class="form-check-label" for="debug">
        Enable debug logging (prints details to terminal)
      </label>
      <div class="form-text">You can also set env var VULNSHERIF_DEBUG=1 to always enable.</div>
    </div>

    <div class="col-12 form-check">
      <input class="form-check-input" type="checkbox" value="on" id="dry_run" name="dry_run">
      <label class="form-check-label" for="dry_run">
        Dry run (don&#39;t call Gemini) &mdash; show packaged payload only
      </label>
    </div>

    <div class="col-12 d-flex gap-3">
      <button class="btn btn-primary" type="submit">Analyze with Gemini</button>
      <button class="btn btn-outline-secondary" type="reset">Reset</button>
    </div>
  </form>
</div>
{% endblock %}
